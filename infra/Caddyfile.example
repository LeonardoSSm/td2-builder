# Replace with your real domain (recommended for automatic HTTPS).
# Example: td2.seudominio.com
YOUR_DOMAIN_HERE {
  encode zstd gzip

  # API (NestJS)
  @api path /api* 
  reverse_proxy @api host.docker.internal:3001

  # Web static build (Vite dist)
  root * /srv/td2/web
  try_files {path} /index.html
  file_server

  header {
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    Referrer-Policy "no-referrer"
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  }
}

# Optional LAN/local block (HTTP only). Useful for tests without domain/TLS:
# :80 {
#   encode zstd gzip
#   @api path /api*
#   reverse_proxy @api host.docker.internal:3001
#   root * /srv/td2/web
#   try_files {path} /index.html
#   file_server
# }

