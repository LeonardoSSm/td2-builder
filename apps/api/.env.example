# API
PORT=3001
CORS_ORIGIN=http://localhost:5173,http://127.0.0.1:5173
JWT_SECRET=change-me-too
JWT_EXPIRES_IN=30m
# When behind a reverse proxy (Caddy/Nginx), set true so IP/rate-limit uses X-Forwarded-For.
TRUST_PROXY=false
ENABLE_HSTS=false
SWAGGER_ENABLED=true
LOGIN_RATE_LIMIT_MAX=10
# Additional global lock per IP (helps against rotating emails)
LOGIN_RATE_LIMIT_MAX_IP=30
LOGIN_RATE_LIMIT_WINDOW_MS=60000
LOGIN_RATE_LIMIT_MAX_KEYS=10000

# Postgres (docker-compose)
DATABASE_URL="postgresql://td2:td2@localhost:5482/td2_builder?schema=public"

# AI (Gemini)
# IMPORTANT: keep API keys out of git. Put the real key in apps/api/.env only.
GEMINI_API_KEY=
GEMINI_MODEL=gemini-2.5-flash
GEMINI_MAX_TOKENS=450
GEMINI_TEMPERATURE=0.6
# If true, /api/ai/chat requires JWT login.
AI_REQUIRE_AUTH=true
# Comma-separated permissions required to use /api/ai/chat (default: admin only).
AI_REQUIRE_PERMISSIONS=ai.chat.use
# AI endpoint rate limit (best-effort, in-memory). Helps prevent abuse/costs.
AI_RATE_LIMIT_MAX=30
AI_RATE_LIMIT_WINDOW_MS=60000

# Optional global API rate limit (best-effort, in-memory)
RATE_LIMIT_MAX=120
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_KEYS=20000

# Optional JWT hardening (leave empty to keep backward-compatible tokens)
JWT_ISSUER=
JWT_AUDIENCE=

# Auth cookies (recommended for web)
COOKIE_SECURE=false
COOKIE_SAMESITE=lax
AUTH_COOKIE_ACCESS=td2_at
AUTH_COOKIE_REFRESH=td2_rt
AUTH_COOKIE_CSRF=td2_csrf
AUTH_REFRESH_DAYS=30
